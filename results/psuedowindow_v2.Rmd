```{r}
require(dplyr)
require(devtools)
require(ggplot2)
require(data.table)
require(parallel)
require(patchwork)
require(lomb)
load_all()

Nmeas = 32 
Nfreq = 25-1  
Nacro = 2^3
mtu = c(1:Nmeas)/Nmeas - 1/Nmeas
mtr = sort(runif(Nmeas))
fmin=1
fmax=24
freqs = c(1,2,4,8,16) 
#acros = seq(0,2*pi,length.out = Nacro+1)
#acros = acros[1:(length(acros)-1)]
acros=c(0,pi/2,pi,3*pi/2)
ldf = rbind(
  lsp_pseudowindow(mtu,freqs,acros,type='unif'),
  lsp_pseudowindow(mtr,freqs,acros,type='rand')
) 
ldf=data.frame(ldf)
head(ldf)

#ldf %>% ggplot(aes(x=freq,y=lfreq,fill=lpower))+geom_raster()+facet_grid(type~acro)
#ldf[ldf$freq==Nmeas/2,] %>% 
#  ggplot(aes(x=lfreq,y=lpower,group=acro))+geom_line()+facet_grid(acro~type)

ldf%>% 
  ggplot(aes(x=lfreq,y=lpower,group=type,color=type))+geom_line()+facet_grid(freq~acro)+geom_vline(aes(xintercept = freq),linewidth=.25)
```