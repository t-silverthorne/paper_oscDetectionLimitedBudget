```{r}
library(reticulate)
use_virtualenv('oscDetectPaper',required = T)
py_config()

py_install('scipy',envname = 'oscDetectPaper')
py_install('cvxpy==1.3.1',envname = 'oscDetectPaper') # using newest version with dsp throws error
py_install('dsp-cvxpy',envname = 'oscDetectPaper')
py_install('gurobipy',envname = 'oscDetectPaper') # for MIQP

py_install('pyscipopt',envname='oscDetectPaper')
```


```{python}
import dsp
import cvxpy as cp
import numpy as np

```

Test of MIQP with gurobi backend
```{python}
Nfine = int(1e1)
Nfreq = int(4)
x     = cp.Variable(Nfine,integer=True)
y     = cp.Variable(Nfreq,integer=True)

A1     = np.random.rand(Nfine,Nfine)
b      = np.random.rand(Nfine)
A2     = np.random.rand(Nfine,Nfine)

obj    = cp.Minimize(cp.sum_squares( A1 @ x - b))

prob   = cp.Problem(obj)
prob.solve(solver='GUROBI',verbose=True)
prob.status
print(x.value)
sum(x.value)
```

Stacking
```{python}
Nmeas=5
X     = cp.hstack([x,x])
AA    = np.random.rand(2*Nfine,2*Nfine)
bb    = cp.hstack([b,b])

obj    = cp.Minimize(cp.sum_squares( AA @ X - bb))

prob   = cp.Problem(obj,[x>=0,sum(x)==Nmeas])
prob.solve(solver='GUROBI',verbose=True)
prob.status
print(x.value)
```


Test of DSP
```{python}
# Creating variables
x = cp.Variable(500)

# Creating local variables
y_loc = dsp.LocalVariable(500)

# Convex in x, concave in y_loc
f = dsp.saddle_inner( x, y_loc)

# maximizes over y_loc
G = dsp.saddle_max(f, [y_loc >= 0, cp.sum(y_loc) == 1])
prob = cp.Problem(cp.Minimize(G), [x >= 0, cp.sum(x) == 1])
prob.solve(solver='GUROBI',reoptimize=True,verbose=True)

```

