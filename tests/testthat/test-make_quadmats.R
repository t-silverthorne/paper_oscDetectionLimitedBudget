#TODO: check that cost_fun option changes quad mat in expected way
